[Settings]

# ────────────────────────────────
# 文件路径配置
# ────────────────────────────────

# 指定频道模板文件（定义你想保留的频道名称，如“CCTV1”、“湖南卫视”）
source_file = config/user_demo.txt

# 指定最终输出结果文件路径（生成的筛选后直播源列表）
final_file = output/user_result.txt


# ────────────────────────────────
# 基础功能开关
# ────────────────────────────────

# 是否启用浏览器自动化采集（通常用于酒店源抓取，一般设为 False）
open_driver = False

# 是否启用电子节目单（EPG），需配合 epg.txt 使用
open_epg = True

# 是否保留空分类（即没有匹配到任何频道的分组）
open_empty_category = False

# 是否根据分辨率过滤（需 FFmpeg 支持）
open_filter_resolution = True

# 是否根据测速结果过滤（结合 min_speed 使用）
open_filter_speed = True

# 是否执行网络测速（检测延迟、带宽、是否可播放）
open_speed_test = True

# 是否自动更新订阅源（从远程 URL 下载最新列表）
open_update = True

# 是否在结果顶部/底部显示更新时间
open_update_time = True

# 是否启动内置 Web 服务（提供 /m3u /txt 接口）
open_service = True


# ────────────────────────────────
# 源类型采集开关
# ────────────────────────────────

# 是否采集“酒店源”（通过特定网站或 API 获取的 IPTV 源）
open_hotel = True

# 是否启用“美食家”风格的酒店源采集（社区贡献的高质量酒店源）
open_hotel_foodie = True

# 是否通过 FOFA 网络空间测绘平台搜索酒店源（需 API 密钥，一般关闭）
open_hotel_fofa = False

# 是否读取本地文件（config/local.txt）中的直播源
open_local = True

# 是否采集组播源（如 rtp://239.x.x.x，通常仅限内网使用）
open_multicast = False   
# ← 建议关闭，避免无效源和 DNS 报错

# 是否启用“美食家”风格的组播源（仍属内网多播，不推荐）
open_multicast_foodie = False

# 是否通过 FOFA 搜索组播源（不实用，关闭）
open_multicast_fofa = False

# 是否启用在线关键词搜索（如百度、Bing 搜直播源，效果差）
open_online_search = False

# 是否从 config/subscribe.txt 中加载远程订阅源
open_subscribe = True


# ────────────────────────────────
# 高级功能开关
# ────────────────────────────────

# 是否生成 .m3u 格式结果文件（标准 IPTV 播放列表）
open_m3u_result = True

# 是否启用 RTMP 推流服务（需公网 IP，将源转为 rtmp:// 地址）
open_rtmp = False

# 是否启用自定义 HTTP 请求头或代理（高级调试用）
open_request = False

# 是否启用“补源”机制（从历史缓存中补充缺失频道）
open_supply = True

# 是否使用缓存加速（避免重复下载相同源）
open_use_cache = True

# 是否记录历史成功源（用于补源和稳定性分析）
open_history = True

# 是否在请求时添加自定义 HTTP 头（如 User-Agent）
open_headers = False

# 是否解析并记录每个 URL 的详细信息（如协议、端口、参数）
open_url_info = True


# ────────────────────────────────
# 网络与服务配置（适用于 Docker 部署）
# ────────────────────────────────

# Web 服务绑定地址（默认 0.0.0.0 表示所有接口）
; app_host = http://0.0.0.0

# Web 服务端口（默认 5180，若改此处需同步改 Docker 映射）
; app_port = 8000

# CDN 加速地址（用于台标 logo 加载，可留空）
; cdn_url =


# ────────────────────────────────
# 各类源的数量限制（每类最多采集多少个有效频道）
# ────────────────────────────────

hotel_num = 15        ; 酒店源最多保留 15 个频道
local_num = 15        ; 本地源最多保留 15 个
multicast_num = 0     ; 组播源数量设为 0（因已关闭采集）
subscribe_num = 20    ; 订阅源最多保留 20 个（略高于其他，因质量较高）
online_search_num = 0 ; 在线搜索源数量（已关闭，设为 0）

# 每个频道最多保留几个不同来源的链接（防重复）
urls_limit = 8


# ────────────────────────────────
# 分页采集配置（用于翻页抓取更多数据）
# ────────────────────────────────

hotel_page_num = 2           ; 酒店源最多采集 2 页
multicast_page_num = 1       ; 组播源页数（已关闭，设为 1 即可）
online_search_page_num = 1   ; 在线搜索页数


# ────────────────────────────────
# 地区过滤配置
# ────────────────────────────────

# 酒店源地区范围（“全部”表示不限制，也可写“北京,上海”）
hotel_region_list = 全部

# 组播源地区范围（同上）
multicast_region_list = 全部


# ────────────────────────────────
# 网络协议类型配置
# ────────────────────────────────

# 允许的 IP 类型（可选：ipv4 / ipv6 / 全部）
ipv_type = ipv4               
# 只使用 IPv4（公网 IPv6 源极少）

# 优先使用的 IP 类型（当同时存在 v4/v6 时选哪个）
ipv_type_prefer = ipv4

# 最终结果中强制保留的 IPv4 源数量（留空表示不限）
ipv4_num =

# 最终结果中强制保留的 IPv6 源数量（留空表示不限）
ipv6_num =

# 是否支持 IPv6 解析（若网络无 IPv6，建议关闭）
ipv6_support = False


# ────────────────────────────────
# 过滤条件（用于筛选高质量源）
# ────────────────────────────────

# 运营商过滤（如“中国电信”，留空表示不限）
isp =

# 地理位置过滤（如“广东”，留空表示不限）
location =

# 最低分辨率要求（低于此值的源会被过滤）
min_resolution = 1280x720

# 最高分辨率上限（防止混入虚假 4K）
max_resolution = 1920x1080

# 最低测速速度（单位：MB/s，低于此值视为卡顿）
min_speed = 0.5               
# 从 1.0 降低，保留更多可用源


# ────────────────────────────────
# 性能与超时配置
# ────────────────────────────────

# 仅使用最近 N 天内成功过的源（结合 open_history）
recent_days = 15

# HTTP 请求超时时间（秒）
request_timeout = 10

# 并发测速的最大线程数（数字越大越快，但可能被限流）
speed_test_limit = 8

# 单个测速任务的最大等待时间（秒）
speed_test_timeout = 8

# 是否在测速前对 IP 做反向 DNS 解析以过滤 CDN/无效主机
# ⚠️ 设为 True 会导致组播/私有 IP 报错 [Errno -2]
speed_test_filter_host = False   
# +关键修复：避免 DNS 解析错误


# ────────────────────────────────
# 源优先级配置（决定多个来源时选哪个）
# ────────────────────────────────

# 来源类型优先级顺序（从左到右优先级递减）
origin_type_prefer = subscribe,local,hotel,multicast


# ────────────────────────────────
# 时间与时区配置
# ────────────────────────────────

# 服务器所在时区（影响更新时间显示）
time_zone = Asia/Shanghai

# 自动更新间隔（小时，仅在持续运行模式下生效）
update_interval = 6

# 更新时间显示位置（top=顶部，bottom=底部）
update_time_position = top
